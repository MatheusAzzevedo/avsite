<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Excursões - Avorar Turismo</title>
<!-- Stylesheets -->
<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
<link rel="icon" href="images/favicon.png" type="image/x-icon">
<!-- Responsive -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<link href="css/responsive.css" rel="stylesheet">
<!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script><![endif]--> 

</head>

<body>
  <div class="site-container">
    <div class="cursor"></div>
    <!-- Preloader -->
    <div class="preloader"></div>

    <a href="https://wa.me/5531981132286" class="whatsapp-float" target="_blank" rel="noopener" aria-label="Fale conosco no WhatsApp"><span class="fab fa-whatsapp"></span></a>

    <div class="menu-backdrop"></div>
        
    <!-- Main Header Bar-->
    <header class="main-header-bar">
        <div class="line-one"></div>
        <div class="line-two"></div>
        <!--Header-Upper-->
        <div class="header-bar-inner">
            <div class="outer-box clearfix">
                
                <!--Nav Toggler-->
                <div class="nav-toggler"><button class="toggler-btn"><span class="bar bar-one"></span><span class="bar bar-two"></span><span class="bar bar-three"></span></button></div>
                
                <!--Social Links-->
                <div class="social-links">
                    <ul class="clearfix">
                        <li><a href="#"><span class="fab fa-instagram"></span></a></li>
                        <li><a href="#"><span class="fab fa-twitter-square"></span></a></li>
                        <li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
                    </ul>
                </div>
                
                <!--Copyright Text-->
                <div class="copyright">&copy; Avorar Turismo 2026</div>
            </div>

            <!--Alt Logo Box-->
            <div class="alt-logo-box"><a href="/"><img src="images/Logo Branca.png" alt="Avorar Turismo"></a></div>
            
            <!--Nav Bg Box-->
            <div class="nav-bg-box"></div>
            
            <!--Main Nav Outer-->
            <div class="main-nav-outer">
                <div class="nav-closer"><img src="images/icons/close-icon.png" alt=""></div>
                <div class="outer-nav-box">
                    <div class="top-bg"></div>
                    <div class="bottom-bg"></div>
                    <div class="main-nav-box" data-scrollbar="">
                        <!--Logo Box-->
                        <div class="main-logo-box"><a href="/"><img src="images/Logo Branca.png" alt="Avorar Turismo"></a></div>
                        <div class="main-nav">
                            <ul class="navigation">
                                <li><a href="/">Início</a></li>
                                <li><a href="/biologia-marinha">Projeto Biologia Marinha</a></li>
                                <li class="current"><a href="/excursoes">Excursões</a></li>
                                <li><a href="about.html">Sobre Nós</a></li>
                                <li><a href="/blog">Blog</a></li>
                                <li><a href="/contato">Contato</a></li>
                                <li><a href="/admin/login.html">Login</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End Header Upper-->
    </header>
    <!--End Main Header -->

    <div class="scroll-container">
        <div class="main-content-container" id="scroll-container" style="background-color: #000000;">
            <div class="body-bg-layer" style="background-image: url(images/background/QDA.jpg); opacity: 0.2;"></div>
            <!-- Page Title -->
            <section class="page-title" id="to-top-div">
                <div class="auto-container">
                    <h1><span>Excursões</span></h1>
                    <div class="bread-crumb">
                        <ul class="clearfix">
                            <li><a href="/">Início</a></li>
                            <li class="current">Excursões</li>
                        </ul>
                    </div>
                </div>
            </section>
            <!--End Banner Section -->


            <!--Portfolio Section-->
            <section class="portfolio-section">
                <div class="auto-container">

                    <div class="mixitup-gallery">

                        <!--Filter-->
                        <div class="gallery-filters centered clearfix">
                            <ul class="filter-tabs filter-btns clearfix" id="filterTabs">
                                <li class="active filter" data-role="button" data-filter="all" onclick="filterExcursoes('all')">Todas</li>
                                <li class="filter" data-role="button" data-filter="natureza" onclick="filterExcursoes('natureza')">Natureza</li>
                                <li class="filter" data-role="button" data-filter="cultura" onclick="filterExcursoes('cultura')">Cultura</li>
                                <li class="filter" data-role="button" data-filter="aventura" onclick="filterExcursoes('aventura')">Aventura</li>
                                <li class="filter" data-role="button" data-filter="marítimo" onclick="filterExcursoes('marítimo')">Marítimo</li>
                            </ul>
                        </div>

                        <div class="filter-list row clearfix" id="excursoesGrid">
                            <!-- Excursões serão carregadas dinamicamente -->
                            <div class="col-12 text-center" id="loadingState" style="padding: 3rem;">
                                <p style="color: #888;">Carregando excursões...</p>
                            </div>
                        </div>

                        <!-- Empty State -->
                        <div id="emptyState" style="display: none; text-align: center; padding: 3rem;">
                            <h3 style="color: #888;">Nenhuma excursão disponível</h3>
                            <p style="color: #666;">Novas experiências em breve!</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

</div>
<!--End Site Container--> 

<!-- Script do cliente da API -->
<script src="js/api-client.js"></script>
<script src="js/jquery.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.fancybox.js"></script>
<script src="js/mixitup.js"></script>
<script src="js/smooth-scrollbar.js"></script>
<script src="js/owl.js"></script>
<script src="js/cursor-script.js"></script>
<script src="js/wow.js"></script>
<script src="js/custom-script.js"></script>
<script>
// Variáveis globais
let allExcursoes = [];
let currentFilter = 'all';

/**
 * Explicação da função [loadExcursoes]
 * Carrega as excursões ativas da API e renderiza na página.
 */
async function loadExcursoes() {
    console.log('[Portfolio] Carregando excursões da API...');
    
    // Aguarda o API Client estar disponível
    if (typeof ExcursaoManager === 'undefined') {
        setTimeout(loadExcursoes, 100);
        return;
    }

    try {
        allExcursoes = await ExcursaoManager.getAll(true); // true = apenas ativas
        renderExcursoes(allExcursoes);
    } catch (error) {
        console.error('[Portfolio] Erro ao carregar excursões:', error);
        document.getElementById('loadingState')?.remove();
        document.getElementById('emptyState').style.display = 'block';
    }
}

/**
 * Explicação da função [renderExcursoes]
 * Renderiza a lista de excursões na página.
 * @param {Array} excursoes - Lista de excursões a renderizar
 */
function renderExcursoes(excursoes) {
    const grid = document.getElementById('excursoesGrid');
    const loadingState = document.getElementById('loadingState');
    const emptyState = document.getElementById('emptyState');

    // Remove loading
    if (loadingState) {
        loadingState.remove();
    }

    if (excursoes.length === 0) {
        grid.innerHTML = '';
        emptyState.style.display = 'block';
        return;
    }

    emptyState.style.display = 'none';

    grid.innerHTML = excursoes.map(excursao => {
        // Usa imagem padrão se não tiver
        const image = excursao.imagemCapa || 'images/background/Queda de agua.webp';
        const categoria = excursao.categoria || 'natureza';
        const preco = ExcursaoManager.formatPrice(excursao.preco);
        
        return `
            <!--Portfolio Block-->
            <div class="portfolio-block mix all ${categoria} col-xl-4 col-lg-4 col-md-6 col-sm-12" data-categoria="${categoria}">
                <div class="inner-box">
                    <div class="image">
                        <img src="${image}" alt="${escapeHtml(excursao.titulo)}" onerror="this.src='images/background/Queda de agua.webp'">
                    </div>
                    <div class="overlay">
                        <div class="more-link">
                            <a href="portfolio-single.html?slug=${excursao.slug}" class="theme-btn">
                                <i class="fa-solid fa-bars-staggered"></i>
                            </a>
                        </div>
                        <div class="inner">
                            <div class="cat"><span>${capitalizeFirst(categoria)}</span></div>
                            <h5><a href="portfolio-single.html?slug=${excursao.slug}">${escapeHtml(excursao.titulo)}</a></h5>
                            <div class="price" style="color: #ff5c00; font-weight: bold; margin-top: 0.5rem;">${preco}</div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

/**
 * Explicação da função [filterExcursoes]
 * Filtra as excursões por categoria.
 * @param {string} categoria - Categoria para filtrar ('all' para todas)
 */
function filterExcursoes(categoria) {
    currentFilter = categoria;

    // Atualiza visual dos filtros
    document.querySelectorAll('#filterTabs .filter').forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.filter === categoria) {
            tab.classList.add('active');
        }
    });

    // Filtra excursões
    let filtered = allExcursoes;
    if (categoria !== 'all') {
        filtered = allExcursoes.filter(e => e.categoria === categoria);
    }

    // Animação de fade
    const items = document.querySelectorAll('.portfolio-block');
    items.forEach(item => {
        const itemCategoria = item.dataset.categoria;
        if (categoria === 'all' || itemCategoria === categoria) {
            item.style.display = 'block';
            item.style.opacity = '1';
        } else {
            item.style.opacity = '0';
            setTimeout(() => {
                item.style.display = 'none';
            }, 300);
        }
    });

    // Atualiza empty state
    const visibleItems = Array.from(items).filter(item => {
        const itemCategoria = item.dataset.categoria;
        return categoria === 'all' || itemCategoria === categoria;
    });

    const emptyState = document.getElementById('emptyState');
    if (visibleItems.length === 0) {
        emptyState.style.display = 'block';
    } else {
        emptyState.style.display = 'none';
    }
}

/**
 * Explicação da função [capitalizeFirst]
 * Capitaliza a primeira letra de uma string.
 */
function capitalizeFirst(str) {
    if (!str) return '';
    return str.charAt(0).toUpperCase() + str.slice(1);
}

/**
 * Explicação da função [escapeHtml]
 * Escapa caracteres HTML para prevenir XSS.
 */
function escapeHtml(text) {
    if (!text) return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Carrega as excursões quando o DOM estiver pronto
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(loadExcursoes, 200);
});
</script>
</body>
</html>
